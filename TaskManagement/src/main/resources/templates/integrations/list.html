<!-- integrations/list.html -->
<div th:fragment="content">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Connected Platforms</h1>
    <button
      class="btn btn-primary"
      data-bs-toggle="modal"
      data-bs-target="#connectPlatformModal"
    >
      <i class="bi bi-plus-lg"></i> Connect Platform
    </button>
  </div>

  <div class="row">
    <div th:each="integration : ${integrations}" class="col-md-6 mb-4">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h5 class="card-title" th:text="${integration.platform.name}">
                Platform
              </h5>
              <p
                class="card-text text-muted"
                th:text="'Connected on ' + ${#temporals.format(integration.connectedOn, 'yyyy-MM-dd')}"
              >
                Connection date
              </p>
            </div>
            <div class="btn-group">
              <button class="btn btn-sm btn-outline-primary">Configure</button>
              <form
                th:action="@{/integrations/{id}(id=${integration.id})}"
                method="post"
              >
                <input type="hidden" name="_method" value="delete" />
                <button type="submit" class="btn btn-sm btn-outline-danger">
                  Disconnect
                </button>
              </form>
            </div>
          </div>

          <div class="mt-3">
            <h6 class="text-muted">Synchronization Settings</h6>
            <form
              th:action="@{/integrations/{id}(id=${integration.id})}"
              method="post"
            >
              <div class="form-check form-switch mb-2">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="syncTasks"
                  th:checked="${integration.syncTasks}"
                  name="syncTasks"
                />
                <label class="form-check-label" for="syncTasks"
                  >Sync Tasks</label
                >
              </div>
              <div class="form-check form-switch mb-2">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="syncComments"
                  th:checked="${integration.syncComments}"
                  name="syncComments"
                />
                <label class="form-check-label" for="syncComments"
                  >Sync Comments</label
                >
              </div>
              <div class="mt-2">
                <button type="submit" class="btn btn-sm btn-primary">
                  Save Settings
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Connect Platform Modal -->
  <div class="modal fade" id="connectPlatformModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Connect New Platform</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
          ></button>
        </div>
        <form th:action="@{/integrations}" method="post">
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Platform</label>
              <select name="platform" class="form-select" required>
                <option value="">Select a platform</option>
                <option
                  th:each="platform : ${availablePlatforms}"
                  th:value="${platform.id}"
                  th:text="${platform.name}"
                >
                  Platform
                </option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">API Key</label>
              <input type="text" name="apiKey" class="form-control" required />
            </div>
            <!-- Additional platform-specific fields would go here -->
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-primary">Connect</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
